<template>
  <div class="page" data-name="resturantcatalog">
    <div class="navbar">
      <div class="navbar-inner sliding ourthemeB">
        <div class="left">
          <a href="#" class="link back">
            <i class="icon icon-back"></i>
            <span class="ios-only">Back</span>
          </a>
        </div>
        <div id="restHead" class="title ourthemeB">{{resturant.title}}</div>
      </div>
    </div>
    <div class="page-content ourthemeB">
        <div style="background-image:url({{resturant.img}})" class="card-header align-items-flex-end restIMG"></div>
      <div class="block-title">{{resturant.adresse}}</div>
      <div class="block block-strong">
        {{resturant.description}} {{resturant.id}}
      </div>
      <div id="visbill" class="showme block">
      <div class="block green" id="ordersumshort">

      </div>
      <a class="link popup-open largerfont" onclick="showtheBill()" href="#" data-popup=".popup-bill"> GÃ¥ til ordre</a>
      </div>
<div class="list accordion-list ourthemeB">
  <p class="giveM">Kategoreier:</p>
    <ul class=" catlist">
         {{#each resturant.categorier}}
              <li class="ourthemeB giveM ourlist">
    <a id="id{{catnavn}}" name="{{catnavn}}" onclick="activeCAT('{{catnavn}}',{{catid}})" href="/cat/{{catid}}/" class="item-link list-button">{{catnavn}}</a>

    </li>
    {{/each}}
                  </ul>
        </div>
    </div>
    <div class="popup popup-bill ">
      <div class="block ourthemeB">

        <!-- Close Popup -->
        <p >Till bestilling<a class="link popup-close rightB textcolloring" href="#">X Steng</a></p>
        <div id="biller" class="ourthemeB">

        </div>
      </div>
    </div>


    <script type="text/javascript">

      function showtheBill(){
          document.getElementById("biller").innerHTML = "";
        theList = orderlist{{resturant.id}};
        console.log(theList);
        let orderSum = 0;
        for (a=0; a<theList.length; a++){
          let sum=theList[a][2]*theList[a][3];
          let text = theList[a][4];
        var element = document.createElement("ul");
        element.classList += "accordion-item";
        element.innerHTML = `
          <hr>
        <a href="" class="item-link item-content textcolloring">
            <div class="item-inner">
                <div class="item-title">${theList[a][5]}</div>
                <div class="textcolloring">
                  <a class="green"> Antall: ${theList[a][2]}</a><a  class="green">  Sum: ${sum}</a>
                </div>
            </div>
        </a>
        <div class="accordion-item-content"><p>Information: </p><a class="red largerfont" onclick="removefromorder(${a})" >Slett</a><p> ${text}</p><p>Valg: </p><p> ${theList[a][6]}</p></div>
    `;
        orderSum+=sum;
        document.getElementById("biller").appendChild(element);

      }
      //[myHat,info,verdi,pris,bTekst,bTitle];<a> Kategori: ${theList[a][0]}   </a><a>Meny element: ${theList[a][1]}</a><a> Antall: ${theList[a][2]}</a><a>  Sum: ${sum}</a>


      let totalSum = document.createElement("div");
      totalSum.innerHTML = `  <hr> Total: ${orderSum}   <hr>`;
        document.getElementById("biller").appendChild(totalSum);
        let bybtn= document.createElement("div");
        bybtn.innerHTML = `<button onclick="sayhu()" href="#" type="button" class="ourbutton" name="button">Bestill</button>
`;
          document.getElementById("biller").appendChild(bybtn);
      }
      function removefromorder(tall){
        console.log(tall);
          console.log(theList);
        theList.splice(tall, 1,);
        console.log(theList);
        showtheBill();
      }
      function sayhu(){
        console.log("sayhu");
        console.log(theList);
      }
    //  console.log(ord3rlist1);
  //  var aktivKatt;
    function activeCAT(cat,hound){
      console.log(cat);
      console.log(hound);
      console.log(`"${cat.name}"`);
      console.log(`${cat.name}`);
      console.log("Creating categoryheader");
      let link = `/cat/${hound}/`;
    //  var aktivKa = eval(cat);
    //  var aktivKatt = aktivKa;
      console.log(cat);
      console.log(link);
    //  setTimeout(luckyS(`${cat}`), 1100);
    //  restNavn("{{resturant.title}}");
      //window.href = link;

      var catname= `${cat}`;
      var restname=document.getElementById("restHead").innerHTML;
      let loremips= "hey hey beskrivelse";
        doheaders(catname,restname,loremips);
      console.log(catname);
      console.log(restname);
    }

    console.log({{resturant.id}});
    var activeResturant = {{resturant.id}};
    var aRName = `{{resturant.title}}`;
      console.log("hei Resturant");
      if (!orderlist{{resturant.id}}){
        var orderlist{{resturant.id}} = [];
        console.log("madeODERLIST");
      }
 //var thevar = orderlist+{{resturant.id}}

//console.log(orderlist{{resturant.id}});
/*function showBill(){
    document.getElementById("biller").innerHTML = "";
  let theList = orderlist{{resturant.id}};
  console.log(theList);
  let orderSum = 0;
  for (a=0; a<theList.length; a++){
    let sum=theList[a][2]*theList[a][3];
    let text = theList[a][4];
  var element = document.createElement("div");
  element.innerHTML = `<a> Kategori: ${theList[a][0]}   </a><a>Meny element: ${theList[a][1]}</a><a> Antall: ${theList[a][2]}</a><a>  Sum: ${sum}</a> <p>Information:  ${text}</p>`;
  orderSum+=sum;
  document.getElementById("biller").appendChild(element);
}
let totalSum = document.createElement("div");
totalSum.innerHTML = `Total: ${orderSum}`;
  document.getElementById("biller").appendChild(totalSum);
}*/
//showBill();
    </script>
  </div>
</template>
<script>
  export default {
    data: function () {
      var resturantId = this.$route.params.id;
      var currentResturant;
      this.$root.resturants.forEach(function (resturant) {
        if (resturant.id === resturantId) {
          currentResturant = resturant;
        }
      });
      return {
        resturant: currentResturant,
      };
    }
  };
</script>
